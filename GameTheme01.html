<!doctypehtml><html lang=ru><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"name=viewport><title>Quiz Game</title><style>body,html{height:100%;width:100%;margin:0;padding:0;position:fixed;overflow:hidden;top:0;left:0;background:#000;touch-action:none}#canvas{display:block;position:fixed;top:0;left:0;width:100%;height:100%;background:#000;object-fit:contain;touch-action:none;image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;will-change:transform;backface-visibility:hidden;z-index:1}#hiddenInput{position:absolute;left:-9999px;top:-9999px;opacity:.01;width:1px;height:1px;font-size:16px;transform:translateZ(0);caret-color:transparent;user-select:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent;pointer-events:none}#hiddenInput:focus{pointer-events:auto}#fullscreenBtn{position:fixed;top:20px;right:20px;z-index:9999;width:44px;height:44px;font-size:24px;font-family:Arial,sans-serif;background-color:rgba(0,0,0,.7);color:#fff;border:2px solid #fff;border-radius:8px;cursor:pointer;user-select:none;transition:background .3s,transform .1s;display:flex;align-items:center;justify-content:center;padding:0}#fullscreenBtn:hover{background-color:rgba(255,255,255,.2)}#fullscreenBtn:active{transform:scale(.95)}#keyboardBtn{position:fixed;bottom:30px;left:50%;transform:translateX(-50%);z-index:10000;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff;border:none;border-radius:25px;padding:15px 30px;font-size:18px;font-family:Arial,sans-serif;font-weight:700;cursor:pointer;user-select:none;transition:all .3s ease;box-shadow:0 4px 20px rgba(0,0,0,.4);display:none;white-space:nowrap;pointer-events:auto;will-change:transform;opacity:.99}#keyboardBtn:hover{transform:translateX(-50%) scale(1.05);box-shadow:0 6px 25px rgba(0,0,0,.5)}#keyboardBtn:active{transform:translateX(-50%) scale(.95)}#keyboardBtn.show{display:block;animation:fadeInUp .5s ease}#keyboardBtn.pulse{animation:pulse 2s infinite}@keyframes fadeInUp{from{opacity:0;transform:translateX(-50%) translateY(20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}@keyframes pulse{0%{box-shadow:0 4px 20px rgba(102,126,234,.6)}50%{box-shadow:0 4px 30px rgba(102,126,234,.9)}100%{box-shadow:0 4px 20px rgba(102,126,234,.6)}}.ios-warning{position:fixed;top:20px;left:50%;transform:translateX(-50%);background:rgba(255,165,0,.95);color:#000;padding:12px 20px;border-radius:15px;font-size:16px;font-family:Arial,sans-serif;text-align:center;z-index:10001;display:none;max-width:90%;box-shadow:0 4px 15px rgba(0,0,0,.3);backdrop-filter:blur(10px)}.ios-warning.show{display:block;animation:slideDown .5s ease}@keyframes slideDown{from{opacity:0;transform:translateX(-50%) translateY(-20px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}.platform-debug{position:fixed;top:10px;left:10px;background:rgba(0,0,0,.85);color:#0f0;padding:12px;border-radius:8px;font-size:12px;font-family:'Courier New',monospace;z-index:10002;display:none;border:1px solid #0f0;max-width:300px}#webviewHint{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.85);color:#fff;padding:25px 35px;border-radius:20px;font-size:20px;font-family:Arial,sans-serif;z-index:9998;pointer-events:none;display:none;text-align:center;box-shadow:0 8px 30px rgba(0,0,0,.5)}#webviewHint.show{display:block;animation:pulse 2s infinite}@supports (-webkit-touch-callout:none){@media (max-width:428px){#fullscreenBtn{display:none!important}}}@media (orientation:portrait){#keyboardBtn{bottom:25px;padding:14px 28px;font-size:17px}}@media (orientation:landscape){#keyboardBtn{bottom:20px;padding:12px 24px;font-size:16px}.ios-warning{top:10px;font-size:14px;padding:10px 16px}}@supports (padding:max(0px)){#keyboardBtn{bottom:max(30px,env(safe-area-inset-bottom))}@media (orientation:portrait){#keyboardBtn{bottom:max(25px,env(safe-area-inset-bottom))}}@media (orientation:landscape){#keyboardBtn{bottom:max(20px,env(safe-area-inset-bottom))}}}</style></head><body><button id=fullscreenBtn title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω">‚õ∂</button> <button id=keyboardBtn>‚å®Ô∏è –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É</button><div id=iosWarning class=ios-warning>üí° –ï—Å–ª–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è - –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ</div><div id=webviewHint>üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏</div><div id=platformDebug class=platform-debug><div id=platformText>Detecting platform...</div></div><canvas id=canvas tabindex=0></canvas><input autocapitalize=off autocomplete=off autocorrect=off id=hiddenInput spellcheck=false><script>const SHELL_VERSION="2.0.3",GameState={INPUT_NAME:"input_name",PLAYING:"playing",GAME_OVER:"game_over"},AppState={currentGameState:GameState.INPUT_NAME,keyboardVisible:!1,preventBlur:!1,backspaceTimeout:null,initialWidth:window.innerWidth,initialHeight:window.innerHeight,inputValue:"",firstTap:!0,keyboardButtonShown:!1,autoShowButtonTimeout:null};function transitionToInputName(){console.log("STATE: Transition to INPUT_NAME");const e=document.getElementById("hiddenInput");document.getElementById("webviewHint");if(!e)return void console.error("hiddenInput not found!");e.value=AppState.inputValue,e.removeAttribute("readonly"),e.removeAttribute("inputmode"),e.removeAttribute("tabindex"),e.style.position="absolute",e.style.left="-9999px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.opacity="0.01",e.style.pointerEvents="none",e.style.zIndex="",AppState.currentGameState=GameState.INPUT_NAME,AppState.firstTap=!0;const t=""!==AppState.inputValue?500:3e3;Module.platformInfo.isMobile&&!Module.platformInfo.isWebView()&&(AppState.autoShowButtonTimeout&&clearTimeout(AppState.autoShowButtonTimeout),AppState.autoShowButtonTimeout=setTimeout((()=>{if(AppState.currentGameState===GameState.INPUT_NAME&&!AppState.keyboardVisible){const e=document.getElementById("keyboardBtn"),o=document.getElementById("iosWarning");e&&o&&(e.classList.add("show","pulse"),o.classList.add("show"),AppState.keyboardButtonShown=!0,console.log(`Keyboard button shown after ${t}ms`))}}),t)),console.log("INPUT_NAME ready, value:",e.value)}function transitionToPlaying(){console.log("STATE: Transition to PLAYING");const e=document.getElementById("hiddenInput"),t=document.getElementById("keyboardBtn"),o=document.getElementById("iosWarning"),n=document.getElementById("webviewHint");if(e){if(AppState.inputValue=e.value,console.log("Player name saved:",AppState.inputValue),document.activeElement===e&&e.blur(),setTimeout((()=>{e.setAttribute("readonly","readonly"),e.setAttribute("inputmode","none"),e.setAttribute("tabindex","-1"),e.style.position="fixed",e.style.top="-9999px",e.style.left="-9999px",e.style.width="1px",e.style.height="1px",e.style.opacity="0",e.style.pointerEvents="none",e.style.zIndex="-1"}),100),t&&t.classList.remove("show","pulse"),o&&o.classList.remove("show"),n&&n.classList.remove("show"),AppState.currentGameState=GameState.PLAYING,AppState.keyboardVisible=!1,AppState.keyboardButtonShown=!1,AppState.autoShowButtonTimeout&&(clearTimeout(AppState.autoShowButtonTimeout),AppState.autoShowButtonTimeout=null),void 0!==Module&&Module.ccall)try{Module.ccall("SetPlayerName",null,["string"],[AppState.inputValue])}catch(e){console.log("SetPlayerName not available:",e)}console.log("PLAYING state ready")}}function transitionToGameOver(){console.log("STATE: Transition to GAME_OVER"),AppState.currentGameState=GameState.GAME_OVER}function hideKeyboard(){transitionToPlaying()}function showInputScreen(){transitionToInputName()}var Module={canvas:document.getElementById("canvas"),platformInfo:{isIOS:/iPhone|iPad|iPod/.test(navigator.userAgent),isAndroid:/Android/.test(navigator.userAgent),isMobile:/iPhone|iPad|iPod|Android/.test(navigator.userAgent),isTelegram:/Telegram/.test(navigator.userAgent)||void 0!==window.TelegramWebviewProxy||window.location.href.includes("tg=")||document.referrer.includes("t.me")||document.referrer.includes("telegram"),isWhatsApp:/WhatsApp/.test(navigator.userAgent),isVK:/VK/.test(navigator.userAgent),isInstagram:/Instagram/.test(navigator.userAgent),isFacebook:/FBAN|FBAV/.test(navigator.userAgent),isSafari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),isChrome:/Chrome/.test(navigator.userAgent)&&!/Edg/.test(navigator.userAgent),isWebView:function(){return this.isTelegram||this.isWhatsApp||this.isVK||this.isInstagram||this.isFacebook||/WebView|Twitter|Line|KAKAOTALK|Slack|Discord/.test(navigator.userAgent)}},hideKeyboard:hideKeyboard,showInputScreen:showInputScreen,transitionToPlaying:transitionToPlaying,transitionToInputName:transitionToInputName,transitionToGameOver:transitionToGameOver,onRuntimeInitialized:function(){if(console.log("=== PLATFORM DETECTION ==="),console.log("UserAgent:",navigator.userAgent),console.log("Platform Details:",{isIOS:this.platformInfo.isIOS,isAndroid:this.platformInfo.isAndroid,isMobile:this.platformInfo.isMobile,isTelegram:this.platformInfo.isTelegram,isWebView:this.platformInfo.isWebView(),isSafari:this.platformInfo.isSafari,isChrome:this.platformInfo.isChrome}),this.ccall){try{this.ccall("StorePlatformInfo",null,["number","number","number","number","number","number","number","number","number","number"],[this.platformInfo.isIOS?1:0,this.platformInfo.isAndroid?1:0,this.platformInfo.isMobile?1:0,this.platformInfo.isTelegram?1:0,this.platformInfo.isWhatsApp?1:0,this.platformInfo.isVK?1:0,this.platformInfo.isInstagram?1:0,this.platformInfo.isFacebook?1:0,this.platformInfo.isSafari?1:0,this.platformInfo.isChrome?1:0])}catch(e){console.log("StorePlatformInfo not available yet:",e)}try{const e=this.ccall("GetDefaultName","string",[],[]);if(e){AppState.inputValue=e;const t=document.getElementById("hiddenInput");t&&(t.value=e),console.log("Default name loaded:",e)}}catch(e){console.log("GetDefaultName not available yet:",e)}}const e=Module.canvas,t=document.getElementById("fullscreenBtn"),o=document.getElementById("keyboardBtn"),n=document.getElementById("iosWarning"),i=document.getElementById("hiddenInput"),a=document.getElementById("webviewHint");if(!(e&&t&&o&&n&&i&&a))return void console.error("Missing elements:",{canvas:e,fsBtn:t,keyboardBtn:o,iosWarning:n,hiddenInput:i,webviewHint:a});function l(){return Module.platformInfo.isMobile&&!Module.platformInfo.isWebView()}function s(){!l()||AppState.currentGameState!==GameState.INPUT_NAME||AppState.keyboardVisible||AppState.keyboardButtonShown||(o.classList.add("show","pulse"),n.classList.add("show"),AppState.keyboardButtonShown=!0,console.log("Keyboard button shown"),setTimeout((()=>{o.classList.contains("show")&&(r(),console.log("Keyboard button auto-hidden after timeout"))}),2e4))}function r(){o.classList.remove("show","pulse"),n.classList.remove("show"),AppState.keyboardButtonShown=!1}function u(){AppState.currentGameState===GameState.INPUT_NAME?AppState.keyboardVisible?console.log("Keyboard already visible"):(console.log("Activating keyboard"),Module.platformInfo.isIOS?function(){console.log("iOS keyboard activation");const e=AppState.inputValue||i.value;console.log("iOS activating with saved value:",e),i.removeAttribute("readonly"),i.removeAttribute("inputmode");const t=document.createElement("input");t.type="text",t.setAttribute("autocomplete","off"),Object.assign(t.style,{position:"fixed",top:"-1000px",left:"-1000px",opacity:"0.001",zIndex:"2147483646",width:"10px",height:"10px",fontSize:"16px"}),document.body.appendChild(t),Promise.resolve().then((()=>{t.focus(),t.select()})).then((()=>{i.value=e,i.focus(),i.select()})).finally((()=>{t.parentNode&&document.body.removeChild(t)})),AppState.keyboardVisible=!0,r(),a&&a.classList.remove("show")}():Module.platformInfo.isAndroid?function(){console.log("Standard keyboard activation");const e=AppState.inputValue||i.value;console.log("Activating with saved value:",e),i.removeAttribute("readonly"),i.removeAttribute("inputmode"),i.style.opacity="0.01",i.style.width="100px",i.style.height="40px",i.style.position="fixed",i.style.top="50%",i.style.left="50%",i.style.zIndex="999999",i.style.fontSize="16px",i.style.pointerEvents="auto",i.setAttribute("inputmode","text"),setTimeout((()=>{i.value=e,i.focus(),i.click()}),10),setTimeout((()=>{i.value=e,i.focus(),i.click(),i.select()}),50),setTimeout((()=>{i.value=e,i.focus()}),100),AppState.keyboardVisible=!0,r(),a&&a.classList.remove("show")}():(console.log("Desktop keyboard activation"),i.removeAttribute("readonly"),i.removeAttribute("inputmode"),i.focus(),AppState.keyboardVisible=!0)):console.log("Keyboard blocked - not INPUT_NAME state")}function p(o){o.target===e?AppState.firstTap&&AppState.currentGameState===GameState.INPUT_NAME&&(Module.platformInfo.isMobile&&!Module.platformInfo.isWebView()&&(t.style.display="none"),u(),AppState.firstTap=!1):console.log("Click ignored - not canvas target")}function d(){const t=AppState.keyboardVisible?{width:AppState.initialWidth,height:AppState.initialHeight}:window.visualViewport?{width:window.visualViewport.width,height:window.visualViewport.height}:{width:window.innerWidth,height:window.innerHeight};e.style.width=t.width+"px",e.style.height=t.height+"px",!AppState.keyboardVisible&&Module.emscripten_force_resize&&setTimeout((()=>Module.emscripten_force_resize()),50)}function c(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}function m(){Module.platformInfo.isWebView()||(c()?(t.textContent="‚õå",t.title="–í—ã–π—Ç–∏ –∏–∑ –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞"):(t.textContent="‚õ∂",t.title="–ü–æ–ª–Ω—ã–π —ç–∫—Ä–∞–Ω"))}i.addEventListener("focus",(t=>{if(i.hasAttribute("readonly"))return console.log("Focus blocked - readonly (PLAYING)"),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i.blur(),e.focus(),!1;if(AppState.currentGameState!==GameState.INPUT_NAME)return console.log("Focus blocked - not INPUT_NAME"),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i.blur(),e.focus(),!1;if(console.log("hiddenInput focused, value:",i.value),!i.value&&AppState.inputValue&&(console.log("Restoring saved value:",AppState.inputValue),i.value=AppState.inputValue),AppState.keyboardVisible=!0,r(),a.classList.remove("show"),Module.ccall)try{Module.ccall("SyncInputText",null,["string"],[i.value])}catch(t){}})),i.addEventListener("blur",(()=>{AppState.preventBlur?(console.log("Preventing blur due to Backspace"),setTimeout((()=>{AppState.currentGameState===GameState.INPUT_NAME&&i.focus()}),150)):(AppState.keyboardVisible=!1,AppState.inputValue=i.value,i.style.opacity="0.01",i.style.width="1px",i.style.height="1px",i.style.position="absolute",i.style.top="-9999px",i.style.left="-9999px",i.style.pointerEvents="none",setTimeout((()=>{AppState.initialWidth=window.innerWidth,AppState.initialHeight=window.innerHeight,d()}),300))})),i.addEventListener("keydown",(e=>{if("Backspace"===e.key){if(e.preventDefault(),AppState.backspaceTimeout&&clearTimeout(AppState.backspaceTimeout),AppState.preventBlur=!0,Module.ccall)try{Module.ccall("HandleBackspace",null,[],[])}catch(e){}AppState.backspaceTimeout=setTimeout((()=>{AppState.preventBlur=!1,AppState.backspaceTimeout=null}),150)}if("Enter"===e.key&&(e.preventDefault(),Module.ccall))try{Module.ccall("HandleEnter",null,[],[])}catch(e){}})),i.addEventListener("input",(e=>{let t=i.value;if(t.length>16&&(t=t.substring(0,16),i.value=t),AppState.inputValue=t,Module.ccall)try{Module.ccall("SyncInputText",null,["string"],[t])}catch(e){}})),i.addEventListener("touchstart",(e=>{if(AppState.currentGameState!==GameState.INPUT_NAME)return e.preventDefault(),e.stopPropagation(),!1}),{passive:!1}),i.addEventListener("click",(e=>{if(AppState.currentGameState!==GameState.INPUT_NAME)return e.preventDefault(),e.stopPropagation(),!1})),document.addEventListener("focusin",(t=>{t.target===i&&AppState.currentGameState!==GameState.INPUT_NAME&&(t.preventDefault(),t.stopPropagation(),i.blur(),e.focus())}),!0),e.addEventListener("pointerup",p),e.addEventListener("click",p),o.addEventListener("pointerup",(e=>{e.preventDefault(),e.stopPropagation(),u()})),o.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),u()})),Module.platformInfo.isWebView()&&Module.platformInfo.isMobile?(t.textContent="‚å®Ô∏è",t.title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤–≤–æ–¥–∞",t.style.width="50px",t.style.height="50px",t.style.fontSize="28px",t.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation(),AppState.currentGameState===GameState.INPUT_NAME&&(u(),t.style.display="none",a.classList.remove("show"))})),a.classList.add("show")):t.addEventListener("click",(e=>{e.stopPropagation(),function(){if(c())document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();else{const e=document.documentElement,t=e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():null;t&&t.then((()=>{m(),d()})).catch((e=>{console.log("Fullscreen error:",e)}))}}()})),["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"].forEach((e=>{document.addEventListener(e,(()=>{m(),setTimeout(d,100)}))})),window.visualViewport&&(window.visualViewport.addEventListener("resize",(()=>{AppState.keyboardVisible||d()})),window.visualViewport.addEventListener("scroll",(()=>{AppState.keyboardVisible||d()}))),window.addEventListener("resize",(()=>{AppState.keyboardVisible||(AppState.initialWidth=window.innerWidth,AppState.initialHeight=window.innerHeight,d())})),window.addEventListener("orientationchange",(()=>{setTimeout((()=>{AppState.initialWidth=window.innerWidth,AppState.initialHeight=window.innerHeight,d(),l()&&AppState.currentGameState===GameState.INPUT_NAME&&setTimeout(s,1e3)}),100)})),document.addEventListener("mousedown",(e=>{if(!Module.platformInfo.isMobile&&AppState.keyboardVisible&&i===document.activeElement)return e.preventDefault(),e.stopPropagation(),!1})),setTimeout((()=>{window.scrollTo(0,1),setTimeout((()=>{window.scrollTo(0,0),AppState.initialWidth=window.innerWidth,AppState.initialHeight=window.innerHeight,d()}),100)}),100),d(),m(),transitionToInputName(),l()&&(AppState.autoShowButtonTimeout=setTimeout((()=>{AppState.currentGameState!==GameState.INPUT_NAME||AppState.keyboardVisible||s()}),3e3)),console.log("=== INITIALIZATION COMPLETE ===");const f=document.getElementById("platformDebug"),h=document.getElementById("platformText");if(f&&h){if(new URLSearchParams(window.location.search).has("debug")){f.style.display="block";const e=`\n                    <strong>Shell v2.0.3</strong><br>\n                    Platform: ${Module.platformInfo.isMobile?"Mobile":"Desktop"}<br>\n                    OS: ${Module.platformInfo.isIOS?"iOS":Module.platformInfo.isAndroid?"Android":"Other"}<br>\n                    Browser: ${Module.platformInfo.isSafari?"Safari":Module.platformInfo.isChrome?"Chrome":"Other"}<br>\n                    WebView: ${Module.platformInfo.isWebView()?"YES":"NO"}<br>\n                    ${Module.platformInfo.isTelegram?"‚úì Telegram<br>":""}\n                    ${Module.platformInfo.isWhatsApp?"‚úì WhatsApp<br>":""}\n                    ${Module.platformInfo.isVK?"‚úì VK<br>":""}\n                    ${Module.platformInfo.isInstagram?"‚úì Instagram<br>":""}\n                    Referrer: ${document.referrer||"direct"}<br>\n                    State: <span id="debugState">${AppState.currentGameState}</span><br>\n                    Input: <span id="debugInput">"${AppState.inputValue}"</span><br>\n                    Keyboard: <span id="debugKeyboard">${AppState.keyboardVisible?"VISIBLE":"hidden"}</span>\n                    `.trim();h.innerHTML=e,f.style.cursor="pointer",f.title="–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å",setInterval((()=>{const e=document.getElementById("debugState"),t=document.getElementById("debugInput"),o=document.getElementById("debugKeyboard");e&&(e.textContent=AppState.currentGameState),t&&(t.textContent=`"${AppState.inputValue}"`),o&&(o.textContent=AppState.keyboardVisible?"VISIBLE":"hidden",o.style.color=AppState.keyboardVisible?"#00ff00":"#888")}),500),f.addEventListener("click",(()=>{f.style.display="none"})),console.log("Debug panel enabled - click to hide")}}console.log("=== INITIALIZATION COMPLETE ===")}};window.hideKeyboard=hideKeyboard,window.showInputScreen=showInputScreen,window.transitionToPlaying=transitionToPlaying,window.transitionToInputName=transitionToInputName,window.transitionToGameOver=transitionToGameOver</script><script async src=GameTheme01.js></script></body></html>